# Royana 整木定制产品导入指南

## 🎯 概述

Royana 产品导入系统是一个基于AI识别数据的智能导入方案，专门为处理从PDF图册AI识别后的产品数据而设计。系统支持多级价格体系，能够智能解析产品编码，并支持手动填写详细产品信息，完美适配整木定制行业的复杂产品结构。

## 🏗️ 核心特性

### **AI数据适配**
- 专门适配PDF图册AI识别后的数据格式
- 支持产品描述、多级价格等复杂字段
- 智能处理编码变体（如 L/R 后缀）

### **多级价格体系**
- 支持价格等级II、III、IV、V的完整价格体系
- 灵活的价格选择策略（默认价格 > 等级III > 等级II）
- 适配不同客户等级的定价需求

### **智能与手动结合**
- 编码智能解析 + 手动填写相结合
- 必填字段最少化（仅需编码和描述）
- 支持详细的产品配置和备注信息

### **完整的产品体系**
- 自动创建品牌、分类、SPU、SKU等完整数据结构
- 支持复杂的产品属性和配件信息
- 建立完整的产品关联关系

## 📋 产品编码规则

### **编码格式**
```
N-[柜体类型][宽度][-抽屉配置]-[高度深度][-门板方向]
```

### **编码组成部分**

#### **前缀 (Prefix)**
- `N-`: 代表 Royana 品牌的 NOVO 产品系列

#### **柜体类型 (Type)**
- `U`: 底柜（Undercounter）
- `US`: 底柜+外置抽屉（Schublade）
- `UC`: 底柜+内置抽屉（Concealed）

#### **尺寸信息**
- **宽度**: 紧随字母后的数字，如 30、60、90（单位：cm）
- **抽屉配置**: 可选，如 -10-（外置抽屉高度）、-30-（3个内置抽屉）
- **高度深度**: 4位数字，前2位高度，后2位深度，如 7256（72cm高，56cm深）

#### **门板方向 (可选)**
- `-L`: 左开（铰链在左）
- `-R`: 右开（铰链在右）

### **编码示例**

| 编码 | 解析结果 |
|------|----------|
| `N-U30-7256` | NOVO系列单门底柜，30×72×56cm |
| `N-US60-10-7256-L` | NOVO系列门抽组合底柜，60×72×56cm，10cm外置抽屉，左开 |
| `N-UC90-30-7256` | NOVO系列内置三抽底柜，90×72×56cm，3个内置抽屉 |

## 📊 导入表格结构

### **必填字段（仅2个）**
| 字段名 | 说明 | 示例 |
|--------|------|------|
| 产品编码 | 符合Royana规范的产品编码 | N-U30-7256-L/R |
| 产品描述 | AI识别的产品描述 | 单门底柜 1 door base unit H.720 D.560 |

### **价格字段（至少填写一个）**
| 字段名 | 说明 | 示例 |
|--------|------|------|
| 价格等级II | 价格等级II（元） | 3730.00 |
| 价格等级III | 价格等级III（元） | 3970.00 |
| 价格等级IV | 价格等级IV（元） | 4180.00 |
| 价格等级V | 价格等级V（元） | 4810.00 |
| 默认销售价格 | 默认销售价格（元），可选 | 3970.00 |

### **产品信息字段（可选，支持智能解析）**
| 字段名 | 说明 | 智能解析 |
|--------|------|----------|
| 产品名称 | 产品显示名称 | 从描述生成 |
| 品牌编码 | 品牌编码 | 从编码解析，默认ROYANA |
| 产品系列 | 产品系列 | 从编码解析，默认NOVO |
| 柜体类型 | 柜体类型 | 从编码和描述解析 |
| 门板数量 | 门板数量 | 从编码和描述解析 |
| 抽屉数量 | 抽屉数量 | 从编码和描述解析 |
| 抽屉类型 | 抽屉类型 | 从编码解析 |
| 宽度/高度/深度 | 产品尺寸（cm） | 从编码解析 |
| 门板方向 | 门板开启方向 | 从编码解析 |

### **详细配置字段（可选）**
| 字段名 | 说明 | 用途 |
|--------|------|------|
| 备注说明 | 产品备注 | AI识别的Remarks字段 |
| 配件清单 | 产品配件 | 详细配件列表 |
| 安装说明 | 安装注意事项 | 安装指导 |
| 主分类 | 主分类 | 产品分类管理 |
| 子分类 | 子分类 | 细分分类 |
| 英文名称 | 英文名称 | 国际化支持 |

### **业务字段（可选）**
| 字段名 | 说明 | 默认值 |
|--------|------|--------|
| 成本价格 | 产品成本价（元） | 0.00 |
| 库存数量 | 初始库存数量 | 0 |
| 最小库存 | 库存预警线 | 10 |
| 产品状态 | 产品状态 | active |
| 规格说明 | 技术规格参数 | 空 |
| 使用场景 | 适用场景说明 | 空 |
| 产品特色 | 产品特色卖点 | 空 |

## 🚀 使用步骤

### **1. 准备AI识别数据**
1. 使用AI工具识别PDF图册，获得类似以下格式的数据：
   ```
   |Description|code|Ⅱ|Ⅲ|Ⅳ|Ⅴ|Remarks|
   |单门底柜 1 door base unit H.720 D.560|N-U30-7256-L/R|3,730|3,970|4,180|4,810|一块可调节隔板|
   ```

2. 对AI识别数据进行二次分析和清理
3. 补充必要的产品信息

### **2. 获取导入模板**
```bash
# 创建Royana导入模板
python manage.py create_royana_template

# 生成Excel模板文件
python manage.py shell -c "
from products.utils.template_generator import ExcelTemplateGenerator
generator = ExcelTemplateGenerator()
excel_file = generator.generate_template('royana_products', include_sample=True)
with open('Royana导入模板.xlsx', 'wb') as f:
    f.write(excel_file.getvalue())
print('模板已生成: Royana导入模板.xlsx')
"
```

### **3. 填写产品数据**
1. 打开生成的Excel模板
2. 查看"字段说明"工作表了解字段含义
3. 在"产品数据"工作表中填写产品信息：
   - **必填**：产品编码、产品描述
   - **价格**：至少填写一个价格等级
   - **其他**：可选填写，系统会智能处理

### **4. 数据填写示例**
```excel
产品编码: N-U30-7256-L/R
产品描述: 单门底柜 1 door base unit H.720 D.560
价格等级II: 3730.00
价格等级III: 3970.00
价格等级IV: 4180.00
价格等级V: 4810.00
备注说明: 一块可调节隔板
```

### **5. 执行导入**
1. 登录Django Admin管理后台
2. 进入"导入任务"页面
3. 创建新的导入任务：
   - 任务名称：填写描述性名称（如：Royana产品批量导入_20250120）
   - 导入类型：选择"产品数据"
   - 上传文件：选择填写好的Excel文件
4. 保存并等待处理完成

### **6. 查看结果**
- 导入完成后查看任务状态和统计信息
- 检查"导入错误"记录了解失败原因
- 在产品管理页面验证导入的数据
- 检查自动创建的品牌、分类、SPU等数据

## 🔧 技术实现

### **核心组件**
- **编码解析器**: `products.utils.royana_code_parser`
- **导入服务**: `products.services.import_service`
- **模板生成器**: `products.utils.template_generator`
- **导入模板**: `products.config.royana_import_template`

### **数据流程**
1. **编码解析**: 解析产品编码获取产品信息
2. **数据验证**: 验证编码格式和数据完整性
3. **实体创建**: 自动创建品牌、分类、SPU等实体
4. **关系建立**: 建立产品间的关联关系
5. **属性配置**: 创建产品属性和属性值

### **错误处理**
- 编码格式验证
- 数据类型检查
- 业务规则验证
- 详细错误记录

## 📈 优势特点

### **效率提升**
- 减少90%的手工数据录入
- 自动化产品信息解析
- 批量导入支持

### **数据准确性**
- 标准化编码规则
- 自动数据验证
- 一致性保证

### **易于维护**
- 模块化设计
- 可扩展架构
- 完整的错误处理

## 🎉 总结

Royana产品导入系统专门为AI识别数据设计，完美适配从PDF图册到产品数据库的完整流程。系统具有以下特点：

### **🎯 核心优势**
- **AI数据友好**：专门适配AI识别后的数据格式
- **最少必填字段**：仅需产品编码和描述两个必填字段
- **多级价格支持**：完整支持II-V级价格体系
- **智能与手动结合**：编码解析 + 手动填写的完美结合
- **完整数据结构**：自动创建品牌、分类、SPU、SKU等完整体系

### **📈 业务价值**
- **效率提升**：从AI识别到产品入库的一站式解决方案
- **数据准确性**：智能解析减少人工错误
- **灵活性**：支持复杂的产品配置和多样化需求
- **可扩展性**：模块化设计，易于扩展其他产品系列

### **🔧 技术特色**
- **智能编码解析**：自动识别产品编码中的所有信息
- **多级价格处理**：灵活的价格选择和处理策略
- **完整属性系统**：自动创建产品属性和属性值
- **错误处理**：完善的验证和错误提示机制

这个系统真正实现了从AI识别数据到完整产品信息的智能化转换，为整木定制行业的数字化转型提供了强有力的技术支撑。
