# ğŸ”§ å¯¼å…¥æ•°æ®é—®é¢˜ä¿®å¤æ€»ç»“

## ğŸš¨ å‘ç°çš„é—®é¢˜

### 1. **SPUå±æ€§å…³è”ç¼ºå¤±** âŒ
**é—®é¢˜**ï¼šå¯¼å…¥æ—¶æ²¡æœ‰ä¸ºSPUåˆ›å»ºå±æ€§å…³è”ï¼Œå¯¼è‡´SPUæ— æ³•æ­£ç¡®ç®¡ç†å…¶æ”¯æŒçš„å±æ€§
**å½±å“**ï¼šäº§å“é…ç½®ç•Œé¢æ— æ³•æ˜¾ç¤ºæ­£ç¡®çš„å±æ€§é€‰é¡¹

### 2. **å±æ€§å’Œå±æ€§å€¼åˆ›å»ºé”™è¯¯** âŒ
**é—®é¢˜**ï¼šä½¿ç”¨äº†é”™è¯¯çš„å­—æ®µåç§°åˆ›å»ºå±æ€§å’Œå±æ€§å€¼
- `display_name` â†’ åº”è¯¥æ˜¯ `name`
- `data_type` â†’ åº”è¯¥æ˜¯ `type`
- `is_variant` â†’ æ¨¡å‹ä¸­ä¸å­˜åœ¨æ­¤å­—æ®µ
- `display_value` â†’ åº”è¯¥æ˜¯ `display_name`

### 3. **SKUè§„æ ¼å±æ€§ä¸å…¨** âŒ
**é—®é¢˜**ï¼šåªåˆ›å»ºäº†å®½åº¦å±æ€§ï¼Œå…¶ä»–é‡è¦å±æ€§ï¼ˆé«˜åº¦ã€æ·±åº¦ã€æŸœä½“ç±»å‹ç­‰ï¼‰æ²¡æœ‰æ­£ç¡®åˆ›å»º
**å½±å“**ï¼šäº§å“ä¿¡æ¯ä¸å®Œæ•´ï¼Œæ— æ³•è¿›è¡Œæœ‰æ•ˆçš„ç­›é€‰å’Œå±•ç¤º

### 4. **å±æ€§ç¼–ç ç¼ºå¤±** âŒ
**é—®é¢˜**ï¼šåˆ›å»ºå±æ€§æ—¶æ²¡æœ‰è®¾ç½®æ­£ç¡®çš„ç¼–ç ï¼Œå¯¼è‡´å±æ€§æŸ¥æ‰¾å’Œç®¡ç†å›°éš¾

## âœ… ä¿®å¤æ–¹æ¡ˆ

### 1. **ä¿®å¤å±æ€§åˆ›å»ºé€»è¾‘**
```python
# ä¿®å¤å‰ï¼šé”™è¯¯çš„å­—æ®µå
attribute, created = Attribute.objects.get_or_create(
    name=attr_name,
    defaults={
        'display_name': attr_name,  # âŒ é”™è¯¯å­—æ®µ
        'data_type': self._determine_attribute_type(attr_value),  # âŒ é”™è¯¯å­—æ®µ
        'is_variant': attr_name in ['å®½åº¦', 'é«˜åº¦', 'æ·±åº¦']  # âŒ ä¸å­˜åœ¨å­—æ®µ
    }
)

# ä¿®å¤åï¼šæ­£ç¡®çš„å­—æ®µå
attribute, created = Attribute.objects.get_or_create(
    code=attr_code,  # âœ… ä½¿ç”¨ç¼–ç ä½œä¸ºå”¯ä¸€æ ‡è¯†
    defaults={
        'name': attr_name,  # âœ… æ­£ç¡®å­—æ®µ
        'type': self._determine_attribute_type(attr_value),  # âœ… æ­£ç¡®å­—æ®µ
        'is_filterable': attr_name in ['å®½åº¦', 'é«˜åº¦', 'æ·±åº¦', 'é—¨æ¿æ–¹å‘', 'æŸœä½“ç±»å‹']  # âœ… æ­£ç¡®å­—æ®µ
    }
)
```

### 2. **æ·»åŠ å±æ€§ç¼–ç æ˜ å°„**
```python
def _generate_attribute_code(self, attr_name: str) -> str:
    """ç”Ÿæˆå±æ€§ç¼–ç """
    code_mapping = {
        'å®½åº¦': 'WIDTH',
        'é«˜åº¦': 'HEIGHT', 
        'æ·±åº¦': 'DEPTH',
        'æŸœä½“ç±»å‹': 'CABINET_TYPE',
        'é—¨æ¿æ–¹å‘': 'DOOR_DIRECTION',
        'é…ç½®ä»£ç ': 'CONFIG_CODE',
        'å¤‡æ³¨è¯´æ˜': 'REMARKS',
        'è‹±æ–‡åç§°': 'ENGLISH_NAME',
        'ä»·æ ¼ç­‰çº§I': 'PRICE_LEVEL_1',
        # ... æ›´å¤šæ˜ å°„
    }
    return code_mapping.get(attr_name, attr_name.upper().replace(' ', '_'))
```

### 3. **è‡ªåŠ¨åˆ›å»ºSPUå±æ€§å…³è”**
```python
def _ensure_spu_attribute(self, spu: SPU, attribute: Attribute):
    """ç¡®ä¿SPUå…³è”äº†æŒ‡å®šå±æ€§"""
    SPUAttribute.objects.get_or_create(
        spu=spu,
        attribute=attribute,
        defaults={
            'is_required': attribute.code in ['WIDTH', 'CABINET_TYPE'],
            'order': self._get_attribute_order(attribute.code)
        }
    )
```

### 4. **å®Œå–„å±æ€§ç±»å‹åˆ¤æ–­**
```python
def _determine_attribute_type(self, value) -> str:
    """æ™ºèƒ½ç¡®å®šå±æ€§ç±»å‹"""
    if isinstance(value, (int, float)):
        return 'number'
    elif isinstance(value, str):
        if value in ['å·¦å¼€', 'å³å¼€', 'å·¦å¼€/å³å¼€', 'åŒå¼€', '-']:
            return 'select'
        elif len(value) < 50:
            return 'select'
        else:
            return 'text'
    else:
        return 'text'
```

## ğŸ¯ ä¿®å¤æ•ˆæœ

### âœ… **é—®é¢˜è§£å†³æƒ…å†µ**

| é—®é¢˜ | ä¿®å¤å‰ | ä¿®å¤å | çŠ¶æ€ |
|------|--------|--------|------|
| SPUå±æ€§å…³è” | âŒ 0ä¸ªå…³è” | âœ… 12ä¸ªå®Œæ•´å…³è” | å·²è§£å†³ |
| å±æ€§åˆ›å»º | âŒ å­—æ®µé”™è¯¯ | âœ… æ­£ç¡®å­—æ®µå’Œç¼–ç  | å·²è§£å†³ |
| SKUå±æ€§å®Œæ•´æ€§ | âŒ ä»…1ä¸ªå±æ€§ | âœ… 12ä¸ªå®Œæ•´å±æ€§ | å·²è§£å†³ |
| å±æ€§å€¼åˆ›å»º | âŒ å­—æ®µé”™è¯¯ | âœ… æ­£ç¡®åˆ›å»ºå’Œå…³è” | å·²è§£å†³ |

### ğŸ“Š **æµ‹è¯•ç»“æœå¯¹æ¯”**

#### ä¿®å¤å‰ï¼š
```
SKU: N-U30-7256-L/R
å±æ€§å€¼æ•°é‡: 1
  å®½åº¦: 30
```

#### ä¿®å¤åï¼š
```
SKU: N-U30-7256-L/R - å•é—¨åº•æŸœ30cm
å±æ€§å€¼æ•°é‡: 12
  å®½åº¦ (WIDTH): 30
  é«˜åº¦ (HEIGHT): 72
  æ·±åº¦ (DEPTH): 56
  æŸœä½“ç±»å‹ (CABINET_TYPE): å•é—¨åº•æŸœ
  é—¨æ¿æ–¹å‘ (DOOR_DIRECTION): å·¦å¼€/å³å¼€
  å¤‡æ³¨è¯´æ˜ (REMARKS): ä¸€å—å¯è°ƒèŠ‚éš”æ¿
  è‹±æ–‡åç§° (ENGLISH_NAME): 1 door base unit
  ä»·æ ¼ç­‰çº§I-V: 0, 3730, 3970, 4180, 4810
```

### ğŸš€ **åŠŸèƒ½å¢å¼º**

1. **å®Œæ•´çš„äº§å“ä¿¡æ¯**ï¼šæ‰€æœ‰15åˆ—æ•°æ®éƒ½æ­£ç¡®è§£æå’Œå­˜å‚¨
2. **æ™ºèƒ½å±æ€§ç±»å‹**ï¼šæ ¹æ®æ•°æ®å†…å®¹è‡ªåŠ¨åˆ¤æ–­å±æ€§ç±»å‹
3. **è§„èŒƒçš„ç¼–ç ç³»ç»Ÿ**ï¼šç»Ÿä¸€çš„å±æ€§ç¼–ç ä¾¿äºç®¡ç†
4. **å®Œæ•´çš„å…³è”å…³ç³»**ï¼šSPU-å±æ€§-å±æ€§å€¼-SKUå®Œæ•´é“¾è·¯
5. **æœ‰åºçš„å±æ€§æ˜¾ç¤º**ï¼šæŒ‰é‡è¦æ€§æ’åºçš„å±æ€§æ˜¾ç¤º

## ğŸ‰ **æœ€ç»ˆéªŒè¯**

### âœ… **æ–°å±æ€§åˆ›å»ºéªŒè¯**
- âœ… æŸœä½“ç±»å‹ (CABINET_TYPE) - selectç±»å‹ - å¯ç­›é€‰
- âœ… æ·±åº¦ (DEPTH) - numberç±»å‹ - å¯ç­›é€‰  
- âœ… é—¨æ¿æ–¹å‘ (DOOR_DIRECTION) - selectç±»å‹ - å¯ç­›é€‰
- âœ… é«˜åº¦ (HEIGHT) - numberç±»å‹ - å¯ç­›é€‰
- âœ… å®½åº¦ (WIDTH) - selectç±»å‹ - å¯ç­›é€‰

### âœ… **SPUå±æ€§å…³è”éªŒè¯**
- âœ… 12ä¸ªå±æ€§å®Œæ•´å…³è”
- âœ… é‡è¦å±æ€§è®¾ä¸ºå¿…å¡«ï¼ˆå®½åº¦ã€æŸœä½“ç±»å‹ï¼‰
- âœ… å±æ€§æ˜¾ç¤ºé¡ºåºæ­£ç¡®

### âœ… **æ•°æ®å®Œæ•´æ€§éªŒè¯**
- âœ… æ‰€æœ‰15åˆ—æ•°æ®æ­£ç¡®è§£æ
- âœ… ä»·æ ¼ç­‰çº§ä¿¡æ¯å®Œæ•´ä¿å­˜
- âœ… ä¸­è‹±æ–‡åç§°æ­£ç¡®å¤„ç†
- âœ… å¤‡æ³¨ä¿¡æ¯æ­£ç¡®å­˜å‚¨

## ğŸ“‹ **ä½¿ç”¨å»ºè®®**

### 1. **é‡æ–°å¯¼å…¥å†å²æ•°æ®**
å»ºè®®é‡æ–°å¯¼å…¥ä¹‹å‰çš„æ•°æ®ï¼Œä»¥è·å¾—å®Œæ•´çš„å±æ€§ä¿¡æ¯ï¼š
```bash
# æ¸…ç†æ—§çš„ä¸å®Œæ•´æ•°æ®
# é‡æ–°å¯¼å…¥å®Œæ•´æ•°æ®
```

### 2. **éªŒè¯æ•°æ®å®Œæ•´æ€§**
å¯¼å…¥åæ£€æŸ¥ï¼š
- SPUæ˜¯å¦æœ‰å®Œæ•´çš„å±æ€§å…³è”
- SKUæ˜¯å¦æœ‰æ‰€æœ‰å¿…è¦çš„å±æ€§å€¼
- å±æ€§å€¼æ˜¯å¦æ­£ç¡®åˆ†ç±»ï¼ˆnumber/select/textï¼‰

### 3. **æµ‹è¯•äº§å“é…ç½®**
åœ¨ç®¡ç†ç•Œé¢æµ‹è¯•ï¼š
- äº§å“ç­›é€‰åŠŸèƒ½
- å±æ€§å€¼é€‰æ‹©
- SKUé…ç½®ç•Œé¢

## ğŸ¯ **æ€»ç»“**

**ä¿®å¤çŠ¶æ€ï¼šâœ… å®Œå…¨è§£å†³**

æ‰€æœ‰å‘ç°çš„é—®é¢˜éƒ½å·²ä¿®å¤ï¼š
1. âœ… SPUå±æ€§å…³è”å®Œæ•´åˆ›å»º
2. âœ… å±æ€§å’Œå±æ€§å€¼æ­£ç¡®åˆ›å»º
3. âœ… SKUè§„æ ¼å±æ€§å®Œæ•´
4. âœ… å±æ€§ç¼–ç è§„èŒƒç»Ÿä¸€

ç°åœ¨å¯¼å…¥åŠŸèƒ½å¯ä»¥ï¼š
- æ­£ç¡®è§£ææ‰€æœ‰15åˆ—AIæ•°æ®
- åˆ›å»ºå®Œæ•´çš„äº§å“ä¿¡æ¯ç»“æ„
- å»ºç«‹æ­£ç¡®çš„å±æ€§å…³è”å…³ç³»
- æ”¯æŒæœ‰æ•ˆçš„äº§å“ç­›é€‰å’Œç®¡ç†

**ç”¨æˆ·ç°åœ¨å¯ä»¥äº«å—å®Œæ•´ã€å‡†ç¡®çš„äº§å“æ•°æ®å¯¼å…¥ä½“éªŒï¼** ğŸš€
